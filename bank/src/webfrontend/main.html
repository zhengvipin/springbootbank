<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>华融湘江银行</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="static/lib/H-ui/css/H-ui.min.css">
    <link rel="stylesheet" href="static/lib/H-ui.admin/css/H-ui.admin.css">
    <link rel="stylesheet" href="static/lib/Hui-iconfont/1.0.8/iconfont.css">
    <link rel="stylesheet" href="static/lib/H-ui.admin/skin/default/skin.css" id="skin">
    <link rel="stylesheet" href="static/lib/H-ui.admin/css/style.css">
</head>
<body>
<header class="navbar-wrapper">
    <div class="navbar navbar-fixed-top">
        <div class="container-fluid cl">
            <a class="logo navbar-logo f-l mr-10 hidden-xs">华融湘江银行</a>
            <span class="logo navbar-slogan f-l mr-10 hidden-xs">v1.0
        &nbsp;&nbsp;
		    <span id="username"></span>
			  &nbsp;&nbsp;
		    上次登录时间: <span id="loginDate"></span>
		  </span>
            <a aria-hidden="false" class="nav-toggle Hui-iconfont visible-xs"
               href="javascript:;">&#xe667;</a>
            <nav class="nav navbar-nav">
            </nav>
            <nav id="Hui-userbar"
                 class="nav navbar-nav navbar-userbar hidden-xs">
                <ul class="cl">
                    <li>
                        <span id="state"></span>
                    </li>
                    <li class="dropDown dropDown_hover">
                        <a href="#" class="dropDown_A">
                            <i class="Hui-iconfont">&#xe6d5;</i>
                        </a>
                        <ul class="dropDown-menu menu radius box-shadow">
                            <li><a href="javascript:changePassword('修改密码','changePassword.html',400,300);">修改密码</a></li>
                            <li><a href="javascript:logout();">退出</a></li>
                        </ul>
                    </li>

                    <li id="Hui-skin" class="dropDown right dropDown_hover">
                        <a href="javascript:;" class="dropDown_A" title="换肤">
                            <i class="Hui-iconfont" style="font-size:18px">
                                &#xe62a;
                            </i>
                        </a>
                        <ul class="dropDown-menu menu radius box-shadow">
                            <li>
                                <a href="javascript:;" data-val="default" title="默认（黑色）">
                                    默认（黑色）
                                </a>
                            </li>
                            <li><a href="javascript:;" data-val="blue" title="蓝色">蓝色</a></li>
                            <li><a href="javascript:;" data-val="green" title="绿色">绿色</a></li>
                            <li><a href="javascript:;" data-val="red" title="红色">红色</a></li>
                            <li><a href="javascript:;" data-val="yellow" title="黄色">黄色</a></li>
                            <li><a href="javascript:;" data-val="orange" title="橙色">橙色</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</header>

<aside class="Hui-aside">
    <div class="menu_dropdown bk_2">
        <dl id="menu-toy-type">
            <dt>
                <i class="Hui-iconfont">&#xe72b;</i>&nbsp;玩具分类
                <i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i>
            </dt>
            <dd>
                <ul>
                    <li>
                        <a data-href="#" data-title="机械" href="javascript:void(0);">机械</a>
                    </li>
                    <li>
                        <a data-href="#" data-title="电动" href="javascript:void(0);">电动</a>
                    </li>
                    <li>
                        <a data-href="#" data-title="声控" href="javascript:void(0);">声控</a>
                    </li>
                    <li>
                        <a data-href="#" data-title="遥控" href="javascript:void(0);">遥控</a>
                    </li>
                </ul>
            </dd>
        </dl>

        <dl id="menu-toy">
            <dt>
                <i class="Hui-iconfont">&#xe72b;</i>&nbsp;玩具管理
                <i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i>
            </dt>
            <dd>
                <ul>
                    <li>
                        <a data-href="toylist.html" data-title="玩具管理" href="javascript:void(0);">玩具管理</a>
                    </li>
                </ul>
            </dd>
        </dl>

        <dl id="menu-system" style="display: none">
            <dt>
                <i class="Hui-iconfont">&#xe62e;</i>&nbsp;系统管理
                <i class="Hui-iconfont menu_dropdown-arrow">&#xe6d5;</i>
            </dt>
            <dd>
                <ul>
                    <li>
                        <a data-href="system/setting.html" data-title="系统设置" href="javascript:void(0);">系统设置</a>
                    </li>
                    <li>
                        <a data-href="system/dictionary.html" data-title="数据字典" href="javascript:void(0);">数据字典</a>
                    </li>
                    <li>
                        <a data-href="system/log.html" data-title="系统日志" href="javascript:void(0);">系统日志</a>
                    </li>
                    <li>
                        <a data-href="system/userlist.html" data-title="系统用户管理" href="javascript:void(0);">系统用户管理</a>
                    </li>
                </ul>
            </dd>
        </dl>
    </div>
</aside>

<div class="dislpayArrow hidden-xs">
    <a class="pngfix" href="javascript:void(0);"
       onClick="displaynavbar(this)"></a>
</div>

<section class="Hui-article-box">
    <div id="Hui-tabNav" class="Hui-tabNav hidden-xs">
        <div class="Hui-tabNav-wp">
            <ul id="min_title_list" class="acrossTab cl">
                <li class="active">
                    <span title="我的桌面" data-href="#">我的桌面</span>
                    <em></em>
                </li>
            </ul>
        </div>
        <div class="Hui-tabNav-more btn-group">
            <a id="js-tabNav-prev" class="btn radius btn-default size-S" href="javascript:;">
                <i class="Hui-iconfont">&#xe6d4;</i>
            </a>
            <a id="js-tabNav-next" class="btn radius btn-default size-S" href="javascript:;">
                <i class="Hui-iconfont">&#xe6d7;</i>
            </a>
        </div>
    </div>

    <div id="iframe_box" class="Hui-article">
        <div class="show_iframe">
            <div style="display:none" class="loading"></div>
            <iframe scrolling="yes" frameborder="0" src="system/userlist.html"></iframe>
        </div>
    </div>
</section>

<div class="contextMenu" id="Huiadminmenu">
    <ul>
        <li id="closethis">关闭当前</li>
        <li id="closeall">关闭全部</li>
    </ul>
</div>

<script src="static/js/jquery.2.1.4.min.js"></script>
<script src="static/lib/H-ui/js/H-ui.min.js"></script>
<script src="static/lib/H-ui.admin/js/H-ui.admin.js"></script>
<script src="static/lib/layer/2.4/layer.js"></script>
<script src="static/lib/jquery.contextmenu.r2.js"></script>
<script src="static/js/bank.js"></script>
<script>
    $(window).on('load', () => {
        // 加载当前用户信息
        $.ajax({
            url: BANK_URL + "user",
            type: "GET",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            headers: createAuthorizationTokenHeader(),
            success: function (user, textStatus, jqXHR) {
                //console.log(user);
                if (user) {
                    $("#username").html(user.username);
                    $("#loginDate").html(user.loginDate);

                    // 根据角色加载菜单
                    loadMenu(user.authorities)
                } else {
                    location.href = "index.html"
                }
            },
            error: function (jqXHR, textStatus, errorThrows) {
                console.log("Spring exception.");
                layer.confirm("非授权用户,请先登录!", () => {
                    location.href = "index.html"
                })
            }
        })
    });

    /**
     * 根据角色加载菜单
     */
    function loadMenu(authorities) {
        authorities.forEach((authorityItem) => {
            let authority = authorityItem.authority;
            if (authority === 'ROLE_ADMIN') {
                // 显示系统管理员的菜单
                $("#menu-system").show()
            } else if (authority === 'ROLE_MANAGER') {
                // 显示经理的菜单
            } else if (authority === 'ROLE_CLERK') {
                // 显示办事员的菜单
            }
        })
    }

    /**
     * 修改密码
     */
    function changePassword(title, url, w, h) {
        layer_show(title, url, w, h)
    }

    /**
     * 注销 | 退出
     */
    function logout() {
        layer.confirm("是否确认退出?", () => {
            removeJwtToken();
            location.href = "index.html"
        })
    }
</script>
</body>
</html>